<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UI Element Classifier - ãƒ†ã‚¹ãƒˆç’°å¢ƒ</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: 1fr 400px;
        gap: 20px;
      }
      .test-area {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .classifier-panel {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        position: sticky;
        top: 20px;
        max-height: 80vh;
        overflow-y: auto;
      }
      .section {
        margin-bottom: 30px;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
      }
      .section h3 {
        margin-top: 0;
        color: #333;
      }
      .test-elements {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
      }
      button,
      input,
      select,
      textarea {
        margin: 5px;
        padding: 8px 12px;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      .custom-button {
        background: #007bff;
        color: white;
        padding: 8px 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      .menu {
        display: flex;
        list-style: none;
        padding: 0;
        margin: 0;
        background: #333;
        border-radius: 4px;
      }
      .menu li {
        margin: 0;
      }
      .menu a {
        display: block;
        padding: 10px 15px;
        color: white;
        text-decoration: none;
      }
      .menu a:hover {
        background: #555;
      }
      .card {
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 15px;
        margin: 10px 0;
      }
      .highlight {
        transition: all 0.3s ease;
      }
      .results {
        margin-top: 20px;
      }
      .type-result {
        margin: 10px 0;
        padding: 10px;
        border-radius: 4px;
        border-left: 4px solid;
      }
      .navigation {
        border-left-color: #6f42c1;
        background: #6f42c110;
      }
      .action {
        border-left-color: #007bff;
        background: #007bff10;
      }
      .form {
        border-left-color: #28a745;
        background: #28a74510;
      }
      .toggle {
        border-left-color: #ffc107;
        background: #ffc10710;
      }
      .unknown {
        border-left-color: #dc3545;
        background: #dc354510;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="test-area">
        <h1>ğŸ§ª UI Element Classifier ãƒ†ã‚¹ãƒˆç’°å¢ƒ</h1>
        <p>ã“ã®ç’°å¢ƒã§ã¯ã€æ§˜ã€…ãªUIè¦ç´ ã‚’é…ç½®ã—ã¦åˆ†é¡ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ†ã‚¹ãƒˆã§ãã¾ã™ã€‚</p>

        <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ ã®ãƒ†ã‚¹ãƒˆ -->
        <div class="section">
          <h3>ğŸ§­ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ </h3>
          <div class="test-elements">
            <a href="#section1">ã‚»ã‚¯ã‚·ãƒ§ãƒ³1ã¸</a>
            <a href="/page2">å†…éƒ¨ãƒšãƒ¼ã‚¸</a>
            <a href="https://example.com">å¤–éƒ¨ã‚µã‚¤ãƒˆ</a>
            <a href="mailto:test@example.com">ãƒ¡ãƒ¼ãƒ«é€ä¿¡</a>
            <a href="tel:03-1234-5678">é›»è©±</a>
          </div>
          <ul class="menu">
            <li><a href="#home">ãƒ›ãƒ¼ãƒ </a></li>
            <li><a href="#about">ä¼šç¤¾æ¦‚è¦</a></li>
            <li><a href="#contact">ãŠå•ã„åˆã‚ã›</a></li>
          </ul>
          <nav>
            <a href="#nav1">ãƒŠãƒ“1</a> | <a href="#nav2">ãƒŠãƒ“2</a> |
            <a href="#nav3">ãƒŠãƒ“3</a>
          </nav>
        </div>

        <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¦ç´ ã®ãƒ†ã‚¹ãƒˆ -->
        <div class="section">
          <h3>ğŸ¯ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¦ç´ </h3>
          <div class="test-elements">
            <button onclick="alert('ä¿å­˜ã—ã¾ã—ãŸ')">ä¿å­˜</button>
            <button type="button">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            <input type="button" value="ãƒªã‚»ãƒƒãƒˆ" />
            <div class="custom-button" onclick="console.log('ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³')">ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³</div>
            <span role="button" tabindex="0">ARIAãƒœã‚¿ãƒ³</span>
            <a href="#" role="button">ãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³</a>
            <div data-action="delete" onclick="confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')">å‰Šé™¤</div>
          </div>
        </div>

        <!-- ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã®ãƒ†ã‚¹ãƒˆ -->
        <div class="section">
          <h3>ğŸ“ ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ </h3>
          <form>
            <div class="test-elements">
              <input type="text" placeholder="åå‰" />
              <input type="email" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" />
              <input type="password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" />
              <input type="number" placeholder="å¹´é½¢" />
              <input type="date" />
              <input type="file" />
              <select>
                <option>é¸æŠã—ã¦ãã ã•ã„</option>
                <option>ã‚ªãƒ—ã‚·ãƒ§ãƒ³1</option>
                <option>ã‚ªãƒ—ã‚·ãƒ§ãƒ³2</option>
              </select>
              <textarea placeholder="ã‚³ãƒ¡ãƒ³ãƒˆ"></textarea>
              <input type="submit" value="é€ä¿¡" />
            </div>
          </form>
        </div>

        <!-- åˆ‡ã‚Šæ›¿ãˆè¦ç´ ã®ãƒ†ã‚¹ãƒˆ -->
        <div class="section">
          <h3>ğŸ”„ åˆ‡ã‚Šæ›¿ãˆè¦ç´ </h3>
          <div class="test-elements">
            <label><input type="checkbox" /> ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹1</label>
            <label><input type="checkbox" checked /> ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹2</label>
            <label><input type="radio" name="radio1" /> ãƒ©ã‚¸ã‚ª1</label>
            <label><input type="radio" name="radio1" /> ãƒ©ã‚¸ã‚ª2</label>
            <div role="switch" tabindex="0">ARIAã‚¹ã‚¤ãƒƒãƒ</div>
            <div class="toggle-switch" data-toggle="theme">ãƒ†ãƒ¼ãƒåˆ‡æ›¿</div>
          </div>
        </div>

        <!-- è¤‡åˆãƒ»è¤‡é›‘ãªè¦ç´ ã®ãƒ†ã‚¹ãƒˆ -->
        <div class="section">
          <h3>ğŸ¤” è¤‡åˆãƒ»è¤‡é›‘ãªè¦ç´ </h3>
          <div class="card">
            <h4>å•†å“ã‚«ãƒ¼ãƒ‰</h4>
            <p>å•†å“èª¬æ˜ãƒ†ã‚­ã‚¹ãƒˆ</p>
            <span>ä¾¡æ ¼: Â¥1,000</span>
            <button onclick="addToCart()">ã‚«ãƒ¼ãƒˆã«è¿½åŠ </button>
            <a href="/product/123">è©³ç´°ã‚’è¦‹ã‚‹</a>
          </div>
          <details>
            <summary>å±•é–‹å¯èƒ½ã‚»ã‚¯ã‚·ãƒ§ãƒ³</summary>
            <p>ã“ã“ã«è©³ç´°å†…å®¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
          </details>
          <table>
            <thead>
              <tr>
                <th onclick="sort('name')">åå‰ â†•</th>
                <th onclick="sort('age')">å¹´é½¢ â†•</th>
              </tr>
            </thead>
            <tbody>
              <tr onclick="selectRow(this)">
                <td>ç”°ä¸­å¤ªéƒ</td>
                <td>25</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="classifier-panel">
        <h2>ğŸ¯ åˆ†é¡çµæœ</h2>
        <button
          onclick="classifyElements()"
          style="
            width: 100%;
            margin-bottom: 20px;
            padding: 10px;
            background: #007acc;
            color: white;
            border: none;
            border-radius: 4px;
          "
        >
          è¦ç´ ã‚’åˆ†é¡
        </button>
        <button
          onclick="clearHighlights()"
          style="
            width: 100%;
            margin-bottom: 20px;
            padding: 10px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
          "
        >
          ãƒã‚¤ãƒ©ã‚¤ãƒˆè§£é™¤
        </button>
        <div id="results" class="results"></div>
      </div>
    </div>

    <script>
      // æ–°ã—ã„åˆ†é¡ãƒ­ã‚¸ãƒƒã‚¯ v2.0 - å®Œå…¨ã«æ–°ã—ã„5åˆ†é¡ã‚·ã‚¹ãƒ†ãƒ 
      class UIElementClassifierV2 {
        constructor() {
          this.classifications = {
            navigation: [],
            action: [],
            form: [],
            toggle: [],
            unknown: [],
          };
          this.originalStyles = new Map();
        }

        classifyElements() {
          // åˆ†é¡ã‚’ãƒªã‚»ãƒƒãƒˆ
          Object.keys(this.classifications).forEach(key => {
            this.classifications[key] = [];
          });

          // ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–è¦ç´ ã‚’æ¤œç´¢
          const elements = document.querySelectorAll(`
                    a, button, input, select, textarea,
                    [role="button"], [role="link"], [role="tab"], [role="menuitem"],
                    [role="checkbox"], [role="radio"], [role="switch"],
                    [onclick], [onmousedown], [onmouseup], [onkeydown],
                    [tabindex]:not([tabindex="-1"]),
                    .btn, .button, .toggle-switch, .custom-button,
                    [data-action], [data-toggle], [data-target],
                    details, summary, th[onclick], td[onclick]
                `);

          elements.forEach(element => {
            const classification = this.classifyElement(element);
            this.classifications[classification.type].push({
              element,
              ...classification,
            });
          });

          return this.classifications;
        }

        classifyElement(element) {
          const tagName = element.tagName.toLowerCase();
          const type = element.getAttribute('type');
          const role = element.getAttribute('role');
          const href = element.getAttribute('href');
          const onclick = element.getAttribute('onclick') || element.onclick;
          const className = element.className || '';
          const dataAttributes = [...element.attributes].filter(attr =>
            attr.name.startsWith('data-')
          );

          // 1. ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ï¼ˆæœ€å„ªå…ˆï¼‰
          if (['input', 'select', 'textarea'].includes(tagName)) {
            // ãŸã ã—ã€ãƒœã‚¿ãƒ³ç³»ã‚„ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ç³»ã¯é™¤å¤–
            if (type === 'checkbox' || type === 'radio') {
              return { type: 'toggle', description: `åˆ‡ã‚Šæ›¿ãˆè¦ç´ : ${type}` };
            }
            if (['button', 'submit', 'reset'].includes(type)) {
              return { type: 'action', description: `ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¦ç´ : ${type}ãƒœã‚¿ãƒ³` };
            }
            return { type: 'form', description: `ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ : ${type || tagName}` };
          }

          // 2. åˆ‡ã‚Šæ›¿ãˆè¦ç´ 
          if (
            role === 'switch' ||
            role === 'checkbox' ||
            role === 'radio' ||
            className.match(/toggle|switch/i) ||
            dataAttributes.some(attr => attr.name.match(/toggle/i))
          ) {
            return { type: 'toggle', description: 'åˆ‡ã‚Šæ›¿ãˆè¦ç´ ' };
          }

          // 3. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ 
          if (tagName === 'a' && href) {
            const isExternal = href.startsWith('http') || href.startsWith('//');
            const isAnchor = href.startsWith('#');
            const isSpecial = href.startsWith('mailto:') || href.startsWith('tel:');

            if (role === 'button') {
              return { type: 'action', description: 'ãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³' };
            }

            return {
              type: 'navigation',
              description: isExternal
                ? 'å¤–éƒ¨ãƒªãƒ³ã‚¯'
                : isAnchor
                  ? 'ã‚¢ãƒ³ã‚«ãƒ¼ãƒªãƒ³ã‚¯'
                  : isSpecial
                    ? 'ç‰¹æ®Šãƒªãƒ³ã‚¯'
                    : 'å†…éƒ¨ãƒªãƒ³ã‚¯',
            };
          }

          // 4. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ ï¼ˆrole ã‚„è¦ªè¦ç´ ã§ã®åˆ¤å®šï¼‰
          if (
            role === 'link' ||
            element.closest('nav') ||
            element.closest('[role="navigation"]') ||
            className.match(/nav|menu|breadcrumb/i)
          ) {
            return { type: 'navigation', description: 'ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ ' };
          }

          // 5. ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¦ç´ 
          if (
            tagName === 'button' ||
            role === 'button' ||
            role === 'tab' ||
            role === 'menuitem' ||
            onclick ||
            className.match(/btn|button|action/i) ||
            dataAttributes.some(attr => attr.name.match(/action|target/i)) ||
            tagName === 'summary' ||
            (tagName === 'th' && onclick) ||
            (tagName === 'td' && onclick)
          ) {
            return { type: 'action', description: 'ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¦ç´ ' };
          }

          // 6. ãã®ä»–/ä¸æ˜
          return { type: 'unknown', description: 'åˆ†é¡ä¸æ˜' };
        }

        highlightElements() {
          const colors = {
            navigation: '#6f42c1',
            action: '#007bff',
            form: '#28a745',
            toggle: '#ffc107',
            unknown: '#dc3545',
          };

          Object.entries(this.classifications).forEach(([type, elements]) => {
            elements.forEach(({ element }) => {
              if (!this.originalStyles.has(element)) {
                this.originalStyles.set(element, {
                  outline: element.style.outline,
                  backgroundColor: element.style.backgroundColor,
                  boxShadow: element.style.boxShadow,
                });
              }

              const color = colors[type];
              element.style.outline = `2px solid ${color}`;
              element.style.backgroundColor = `${color}20`;
              element.style.boxShadow = `0 0 0 1px ${color}`;
            });
          });
        }

        removeHighlights() {
          this.originalStyles.forEach((originalStyle, element) => {
            Object.assign(element.style, originalStyle);
          });
          this.originalStyles.clear();
        }

        getStatistics() {
          const stats = {};
          Object.entries(this.classifications).forEach(([type, elements]) => {
            stats[type] = elements.length;
          });
          return stats;
        }
      }

      let classifier = new UIElementClassifierV2();

      function classifyElements() {
        classifier.removeHighlights();
        const classifications = classifier.classifyElements();
        classifier.highlightElements();
        displayResults(classifications);
      }

      function clearHighlights() {
        classifier.removeHighlights();
      }

      function displayResults(classifications) {
        const resultsDiv = document.getElementById('results');
        const typeNames = {
          navigation: 'ğŸ§­ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³',
          action: 'ğŸ¯ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³',
          form: 'ğŸ“ ãƒ•ã‚©ãƒ¼ãƒ ',
          toggle: 'ğŸ”„ åˆ‡ã‚Šæ›¿ãˆ',
          unknown: 'â“ ä¸æ˜',
        };

        let html = '';
        Object.entries(classifications).forEach(([type, elements]) => {
          if (elements.length > 0) {
            html += `<div class="type-result ${type}">
                        <strong>${typeNames[type]}: ${elements.length}ä»¶</strong>
                        <ul>`;
            elements.forEach(({ element, description }) => {
              const elementInfo = `${element.tagName.toLowerCase()}${element.id ? '#' + element.id : ''}${element.className ? '.' + element.className.split(' ')[0] : ''}`;
              html += `<li>${elementInfo} - ${description}</li>`;
            });
            html += `</ul></div>`;
          }
        });

        resultsDiv.innerHTML = html || '<p>åˆ†é¡å¯èƒ½ãªè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>';
      }

      // ãƒ€ãƒŸãƒ¼é–¢æ•°
      function addToCart() {
        alert('ã‚«ãƒ¼ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸ');
      }
      function sort(column) {
        alert(`${column}ã§ã‚½ãƒ¼ãƒˆã—ã¾ã™`);
      }
      function selectRow(row) {
        alert('è¡Œã‚’é¸æŠã—ã¾ã—ãŸ');
      }
    </script>
  </body>
</html>
