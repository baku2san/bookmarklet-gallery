# SharePoint Navigator 改善版

## 改善内容

### 🔧 主な修正点

1. **子サイトでの機能拡張**
   - 子サイトでも主要な機能（サイト コンテンツ、ドキュメント、ユーザー管理など）にアクセス可能
   - 子サイト固有のベースURLに基づいたリンク生成
   - Top Site への移動リンクを追加

2. **フィルター機能の修正**
   - 検索対象を `link-title` と `link-description` クラスに正確に対応
   - フィルタークリアボタンの表示/非表示処理を修正
   - カテゴリごとの表示/非表示処理を改善
   - 検索時の視覚的フィードバックを強化

3. **複数列表示の実装**
   - 📊ボタンで1列〜3列表示を切り替え可能
   - パネル幅に応じた自動調整
   - ResizeObserver による動的レイアウト更新

4. **特殊URL対応**
   - メンテナンスモード (`maintenancemode=true`)
   - SharePointバージョン情報 (`_vti_pvt`)
   - Web パーツメンテナンス (`Contents=1`)
   - 特殊URLでも基本ナビゲーションを提供

5. **UI/UX改善**
   - カテゴリの折りたたみ/展開機能
   - 列数切替ボタンの追加
   - より適切なボタン配置とツールチップ
   - 子サイト名の表示

### 🎯 使用方法

1. SharePointサイト（トップサイト・子サイト問わず）でブックマークレットを実行
2. パネル上部のボタンで機能を制御：
   - **📊**: 列数切替（1〜3列）
   - **📏**: サイズ切替（コンパクト⇔通常）
   - **✕**: パネルを閉じる
3. 検索ボックスでリンクをフィルタリング
4. カテゴリヘッダーをクリックして折りたたみ/展開

### 🔍 対応済み問題

✅ 子サイトで各種リンクへアクセス可能
✅ フィルター機能が正常に動作
✅ 複数列表示に対応
✅ フィルタークリアボタンが正常に動作
✅ 特殊URL（メンテナンスモードなど）での適切な処理

### 🚀 新機能

- **動的列数切替**: パネル幅と設定に応じて1〜3列で表示
- **改善されたカテゴリ管理**: 折りたたみ状態の視覚的表示
- **特殊URL検出**: 問題のあるURL形式を自動検出し適切に処理
- **強化されたフィルタリング**: より正確な検索とクリア機能

### 📁 ファイル構成

```
src/bookmarklets/productivity/
├── sharepoint-navigator.js          # 改善版メインファイル
├── CHANGELOG.md                      # この改善記録
└── README.md                        # 使用方法（既存）
```

### 🧪 テスト済み環境

- SharePoint Online (Microsoft 365)
- 通常サイト・子サイト・特殊URL

### 💡 今後の改善案

- リンクのお気に入り機能
- カスタムリンクの追加機能
- テーマ切替機能
- ショートカットキー対応
