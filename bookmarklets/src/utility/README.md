# 🛠️ Utility Tools

このディレクトリには、日常的に使用する便利なユーティリティブックマークレットが含まれています。

## 📋 収録ツール

### 🔧 Utility Tools (統合版)

**ファイル:** `utility-tools.js`

URL 操作、言語切り替え、Office ダウンロードなどの便利機能を統合したマルチツール。パネル形式の UI で複数の機能を簡単に利用できます。

**主な機能:**

- **URL エンコード・デコード**: 現在の URL をエンコード/デコードしてクリップボードにコピー
- **多言語 URL 切り替え**: en/ja、en-us/ja-jp 間での URL 言語切り替え（Microsoft Learn 等対応）
- **Office 365 文書ダウンロード**: SharePoint、OneDrive の文書を直接ダウンロード
- **HTTP→HTTPS 変換**: セキュアな接続への自動切り替え
- **クエリパラメータ削除**: URL からクエリパラメータを削除したクリーンな URL を生成
- **ページ情報取得**: ページのメタデータや詳細情報を取得してコピー
- **直感的なパネル UI**: 使いやすいグラフィカルインターフェース

**対応パターン:**

```text
URL言語切り替え:
  /en-us/ ⇔ /ja-jp/ (Microsoft系)
  /en/ ⇔ /ja/ (一般的)
  ?lang=en ⇔ ?lang=ja (クエリパラメータ)

Office文書ダウンロード:
  /Doc.aspx?sourcedoc=... → /download.aspx?UniqueId=...
  /_layouts/15/Doc.aspx → /_layouts/15/download.aspx
  onedrive.live.com/.../view.aspx → .../download.aspx
```

## 🎯 使用方法

1. ブックマークレットを実行すると、右上にパネルが表示されます
2. 各機能ボタンをクリックして実行
3. 結果は視覚的なフィードバックで通知されます
4. パネル右上の「×」ボタンで閉じることができます

## 🔧 開発者向け情報

### ファイル構造

```text
src/utility/
├── README.md              # このファイル
└── utility-tools.js       # 統合版マルチツール
```

### 技術仕様

- **Clipboard API 対応**: 最新の Clipboard API を使用（フォールバック付き）
- **視覚的フィードバック**: 通知システムで操作結果を表示
- **エラーハンドリング**: 適切なエラー処理と回復機能
- **レスポンシブ対応**: モバイル・デスクトップ両対応
- **セキュリティ**: XSS 対策済み、安全な DOM 操作

### カスタマイズ

新しい機能を追加する場合は、`UtilityFeatures` オブジェクトに関数を追加し、UI のボタン設定を更新してください。

## 📝 更新履歴

- **2025-06-22**: 初版リリース
  - URL エンコード・デコード機能
  - 多言語 URL 切り替え機能
  - Office 365 文書ダウンロード機能
  - HTTP→HTTPS 変換機能
  - クエリパラメータ削除機能
  - ページ情報取得機能
  - 統合 UI 実装
